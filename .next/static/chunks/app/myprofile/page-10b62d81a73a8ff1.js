(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[546],{3614:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>h});var s=a(5155),l=a(2115),n=a(2619),i=a.n(n),r=a(2078),d=a(1328),o=a(9708);let c=(0,r.Wp)({apiKey:"AIzaSyBtsOBlh52YZagsLXp9_dcCq4qhkHBSWnU",authDomain:"thepub-sigma.firebaseapp.com",projectId:"thepub-sigma"}),u=(0,o.aU)(c),m=(0,d.xI)(c),h=()=>{let e,[t,a]=(0,l.useState)(null),[n,r]=(0,l.useState)(null),[c,h]=(0,l.useState)(null),[v,p]=(0,l.useState)(new URLSearchParams(window.location.search).get("user")),[x,g]=(0,l.useState)(null),[b,y]=(0,l.useState)(null),[j,w]=(0,l.useState)(!0),[N,f]=(0,l.useState)(!1),[S,k]=(0,l.useState)(""),[A,C]=(0,l.useState)("wall"),[P,B]=(0,l.useState)([]),[I,U]=(0,l.useState)([]),[F,E]=(0,l.useState)([]),[M,H]=(0,l.useState)(!1),[L,T]=(0,l.useState)(!1),[_,R]=(0,l.useState)(!1),[D,G]=(0,l.useState)(!1),[O,z]=(0,l.useState)(""),[J,W]=(0,l.useState)(""),[Z,q]=(0,l.useState)(""),[V,Y]=(0,l.useState)(""),[K,X]=(0,l.useState)({triviaAvg:"N/A",playerAvg:"N/A",collegeAvg:"N/A"}),[Q,$]=(0,l.useState)(""),[ee,et]=(0,l.useState)([]),[ea,es]=(0,l.useState)([]),[el,en]=(0,l.useState)(null);(0,l.useEffect)(()=>(document.body.style.backgroundImage="url('https://www.transparenttextures.com/patterns/wood-pattern.png'), linear-gradient(135deg, #26313d 0%, #4c2b16 100%)",document.body.style.backgroundSize="400px, cover",document.body.style.backgroundRepeat="repeat, no-repeat",document.body.style.backgroundAttachment="fixed",document.body.style.minHeight="100vh",document.body.style.fontFamily="'Montserrat', sans-serif",()=>{document.body.style.backgroundImage="",document.body.style.backgroundSize="",document.body.style.backgroundRepeat="",document.body.style.backgroundAttachment="",document.body.style.minHeight="",document.body.style.fontFamily=""}),[]),(0,l.useEffect)(()=>(0,d.hg)(m,async e=>{if(a(e),e){var t,s,l,n,i,d,c,m;h(e.uid);let a=await (0,o.x7)((0,o.H9)(u,"users",e.uid));if(r((null==(t=a.data())?void 0:t.username)||null),v&&v!==(null==(s=a.data())?void 0:s.username)){let e=(0,o.P)((0,o.rJ)(u,"users"),(0,o._M)("username","==",v)),t=await (0,o.GG)(e);if(t.empty){k('User "'.concat(v,'" not found.')),f(!0),y(null),g(null);return}{w(!1);let e=t.docs[0],a=e.data();g(e.id),y(a),B(null!=(l=null==a?void 0:a.wall)?l:[]),U(null!=(n=null==a?void 0:a.takes)?n:[]),E(null!=(i=null==a?void 0:a.teams)?i:[])}}else{w(!0),g(e.uid);let t=a.data();y(t),B(null!=(d=null==t?void 0:t.wall)?d:[]),U(null!=(c=null==t?void 0:t.takes)?c:[]),E(null!=(m=null==t?void 0:t.teams)?m:[])}k(""),f(!1)}else k("Please log in to view profiles."),y(null),f(!0),g(null)}),[v]);let ei=async()=>{if(!x)return X({triviaAvg:"N/A",playerAvg:"N/A",collegeAvg:"N/A"});let e="N/A",t="N/A",a="N/A";try{var s,l,n;let i=await (0,o.x7)((0,o.H9)(u,"triviaAverages",x));i.exists()&&(e=(null!=(s=i.data().averageScore)?s:"N/A").toFixed(2));let r=await (0,o.x7)((0,o.H9)(u,"userAverages",x));r.exists()&&(t=(null!=(l=r.data().averageScore)?l:"N/A").toFixed(2));let d=await (0,o.x7)((0,o.H9)(u,"collegeAverages",x));d.exists()&&(a=(null!=(n=d.data().averageScore)?n:"N/A").toFixed(2)),X({triviaAvg:e,playerAvg:t,collegeAvg:a})}catch(e){X({triviaAvg:"N/A",playerAvg:"N/A",collegeAvg:"N/A"})}},er=async()=>{await (0,d.CI)(m),window.location.href="/"},ed=async e=>{if(e.preventDefault(),!Z.trim())return void z("Enter a username.");let t=(0,o.P)((0,o.rJ)(u,"users"),(0,o._M)("username","==",Z.trim()));if(!(await (0,o.GG)(t)).empty)return void z("That username is taken.");c&&(await (0,o.mZ)((0,o.H9)(u,"users",c),{username:Z.trim()}),r(Z.trim()),z("Updated!"),p(Z.trim()),w(!0))},eo=async e=>{if(e.preventDefault(),!V.trim()||V.length<6)return void W("Password must be at least 6 characters.");if(m.currentUser)try{await (0,d.f3)(m.currentUser,V.trim()),W("Password updated!")}catch(e){W(e.message||"Error updating password.")}else W("Not signed in.")},ec=async()=>(await (0,o.GG)((0,o.rJ)(u,"users"))).docs.map(e=>e.data().username),eu=async e=>{if($(e.target.value),!e.target.value.trim())return void et([]);et((await ec()).filter(t=>t.toLowerCase().includes(e.target.value.trim().toLowerCase())))},em=async()=>{if(!Q.trim())return void es([]);es((await ec()).filter(e=>e.toLowerCase().includes(Q.trim().toLowerCase())))},eh=async e=>{en(e),p(e),es([])},ev=async(e,t)=>{if(x)try{await (0,o.mZ)((0,o.H9)(u,"users",x),{[e]:t})}catch(e){k("Failed to post. Please try again.")}},ep=async e=>{e.preventDefault();let t=document.getElementById("wallInput");if((null==t?void 0:t.value.trim())&&n){let e=[...P,{author:n,text:t.value.trim()}];B(e),await ev("wall",e),t.value=""}},ex=async e=>{e.preventDefault();let t=document.getElementById("takeInput");if(null==t?void 0:t.value.trim()){let e=[...I,t.value.trim()];U(e),await ev("takes",e),t.value=""}},eg=async e=>{let t=I.slice();t.splice(e,1),U(t),await ev("takes",t)},eb=async e=>{e.preventDefault();let t=document.getElementById("teamNameInput");if(null==t?void 0:t.value.trim()){let e=[...F,{name:t.value.trim()}];E(e),await ev("teams",e),t.value=""}},ey=async e=>{let t=F.slice();t.splice(e,1),E(t),await ev("teams",t)};return"wall"===A&&(e=(0,s.jsxs)("div",{children:[(0,s.jsxs)("form",{className:"post-form",id:"wallForm",onSubmit:ep,children:[(0,s.jsx)("input",{type:"text",id:"wallInput",placeholder:j?"Post something on your wall...":"Post something on ".concat(null==b?void 0:b.username,"'s wall..."),maxLength:120}),(0,s.jsx)("button",{type:"submit",children:"Post"})]}),!P.length&&(0,s.jsx)("div",{style:{color:"#aaa",textAlign:"center"},children:"No posts yet."}),P.slice().reverse().map((e,t)=>(0,s.jsxs)("div",{className:"wall-post",children:[(0,s.jsx)("span",{className:"wall-post-author",children:e.author}),e.text]},t))]})),"takes"===A&&(e=(0,s.jsxs)("div",{children:[j&&(0,s.jsxs)("form",{className:"take-form",id:"takeForm",onSubmit:ex,children:[(0,s.jsx)("input",{type:"text",id:"takeInput",placeholder:"Share your take...",maxLength:120}),(0,s.jsx)("button",{type:"submit",children:"Add Take"})]}),!I.length&&(0,s.jsx)("div",{style:{color:"#aaa",textAlign:"center"},children:"No takes yet."}),I.slice().reverse().map((e,t)=>(0,s.jsxs)("div",{className:"my-take",children:[e,j&&(0,s.jsx)("button",{className:"remove-btn",onClick:()=>eg(I.length-1-t),children:"Remove"})]},t))]})),"teams"===A&&(e=(0,s.jsxs)("div",{children:[j&&(0,s.jsxs)("form",{className:"team-form",id:"teamForm",onSubmit:eb,children:[(0,s.jsx)("input",{type:"text",id:"teamNameInput",placeholder:"Team name...",maxLength:60}),(0,s.jsx)("button",{type:"submit",children:"Add Team"})]}),!F.length&&(0,s.jsx)("div",{style:{color:"#aaa",textAlign:"center"},children:"No teams yet."}),F.map((e,t)=>(0,s.jsxs)("div",{className:"team-card",children:[(0,s.jsx)("span",{children:e.name}),j&&(0,s.jsx)("button",{className:"remove-btn",onClick:()=>ey(t),children:"Remove"})]},t))]})),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"pub-sign",id:"pubTitle",children:b?"".concat(b.username,"'s Pub"):"Your Pub"}),(0,s.jsxs)("div",{className:"search-bar-container",children:[(0,s.jsx)("input",{type:"text",id:"searchInput",autoComplete:"off",placeholder:"Search...",value:Q,onChange:eu,onFocus:eu}),(0,s.jsx)("button",{id:"searchBtn",onClick:em,children:"Search"}),ee.length>0&&(0,s.jsx)("ul",{className:"search-dropdown",style:{display:"block"},children:ee.map(e=>(0,s.jsx)("li",{tabIndex:0,"data-username":e,onMouseDown:()=>eh(e),children:e},e))})]}),(0,s.jsxs)("div",{id:"selectedProfileContainer",className:"selected-profile-container",style:{display:el?"":"none"},children:[(0,s.jsx)("span",{className:"selected-profile-label",children:"Current Profile:"}),(0,s.jsx)("span",{className:"selected-profile-name",children:el})]}),(0,s.jsxs)("div",{className:"actions-bar",children:[(0,s.jsx)("button",{className:"action-btn",id:"statsBtn",onClick:()=>{H(!0),ei()},children:"My Stats"}),(0,s.jsx)("button",{className:"action-btn",id:"settingsBtn",onClick:()=>T(!0),children:"Settings"}),(0,s.jsx)(i(),{className:"action-btn home-btn",id:"homeBtn",href:"/",children:"Home"})]}),ea.length>0&&(0,s.jsx)("div",{id:"searchResults",className:"search-results",style:{display:""},children:ea.map(e=>(0,s.jsxs)("div",{className:"user-result",children:[(0,s.jsxs)("span",{children:["@",e]}),(0,s.jsx)("button",{className:"view-profile-btn",onClick:()=>eh(e),children:"View Profile"})]},e))}),S&&(0,s.jsx)("div",{id:"profileError",className:"error-message",style:{display:""},children:S}),(0,s.jsxs)("div",{className:"tv-frame",children:[(0,s.jsx)("div",{className:"tv-bezel",children:"PubTV"}),(0,s.jsxs)("div",{className:"flex flex-row justify-center gap-2 mb-0 pt-2 pb-1",id:"tabBar",children:[(0,s.jsx)("button",{className:"tab-btn".concat("wall"===A?" active":""),"data-tab":"wall",onClick:()=>C("wall"),children:"Wall"}),(0,s.jsx)("button",{className:"tab-btn".concat("takes"===A?" active":""),"data-tab":"takes",onClick:()=>C("takes"),children:"My Takes"}),(0,s.jsx)("button",{className:"tab-btn".concat("teams"===A?" active":""),"data-tab":"teams",onClick:()=>C("teams"),children:"My Teams"})]}),(0,s.jsx)("div",{className:"tv-screen",children:(0,s.jsx)("div",{className:"tv-content",id:"tabContent",children:e})})]}),M&&(0,s.jsx)("div",{className:"modal-bg",id:"statsModalBg",style:{display:"flex"},children:(0,s.jsxs)("div",{className:"modal",id:"statsModal",children:[(0,s.jsx)("button",{className:"close-btn",id:"closeStatsBtn",onClick:()=>H(!1),children:"Close"}),(0,s.jsx)("h2",{style:{marginBottom:"16px"},children:"My Stats"}),(0,s.jsx)("div",{id:"statsContent",children:(0,s.jsxs)("div",{className:"modal-list",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Trivia Avg:"})," ",K.triviaAvg]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Name the Player Avg:"})," ",K.playerAvg]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"College Avg:"})," ",K.collegeAvg]})]})})]})}),L&&(0,s.jsx)("div",{className:"modal-bg",id:"settingsModalBg",style:{display:"flex"},children:(0,s.jsxs)("div",{className:"modal",id:"settingsModal",children:[(0,s.jsx)("button",{className:"close-btn",id:"closeSettingsBtn",onClick:()=>T(!1),children:"Close"}),(0,s.jsx)("h2",{style:{marginBottom:"16px"},children:"Settings"}),!_&&!D&&(0,s.jsxs)("div",{className:"settings-options",id:"settingsOptions",children:[(0,s.jsx)("button",{className:"settings-btn",id:"editUsernameBtn",onClick:()=>{R(!0),G(!1),z(""),q("")},children:"Change Username"}),(0,s.jsx)("button",{className:"settings-btn",id:"editPasswordBtn",onClick:()=>{G(!0),R(!1),W(""),Y("")},children:"Change Password"}),(0,s.jsx)("button",{className:"settings-btn",id:"signOutBtn",onClick:er,children:"Sign Out"})]}),_&&(0,s.jsxs)("form",{id:"usernameForm",onSubmit:ed,children:[(0,s.jsx)("label",{htmlFor:"newUsername",children:"New Username"}),(0,s.jsx)("input",{type:"text",id:"newUsername",autoComplete:"off",style:{width:"90%",padding:"7px",borderRadius:"6px"},value:Z,onChange:e=>q(e.target.value)}),(0,s.jsx)("button",{type:"submit",children:"Update Username"}),(0,s.jsx)("div",{className:"modal-error",id:"usernameError",children:O})]}),D&&(0,s.jsxs)("form",{id:"passwordForm",onSubmit:eo,children:[(0,s.jsx)("label",{htmlFor:"newPassword",children:"New Password"}),(0,s.jsx)("input",{type:"password",id:"newPassword",autoComplete:"off",style:{width:"90%",padding:"7px",borderRadius:"6px"},value:V,onChange:e=>Y(e.target.value)}),(0,s.jsx)("button",{type:"submit",children:"Update Password"}),(0,s.jsx)("div",{className:"modal-error",id:"passwordError",children:J})]})]})})]})}},7696:(e,t,a)=>{Promise.resolve().then(a.bind(a,3614))}},e=>{e.O(0,[135,210,619,353,441,255,358],()=>e(e.s=7696)),_N_E=e.O()}]);